<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <title>FFT visualisation</title>
    <style>
    body {
        margin: 0px;
        overflow: hidden;
    }
    
    #webglviewer {
        bottom: 0;
        left: 0;
        position: absolute;
        right: 0;
        top: 0;
    }
    </style>
</head>

<body>
    <div id="example"></div>
    <script type="text/javascript" src="libs/p5.js"></script>
    <script type="text/javascript" src="libs/p5.sound.js"></script>
    <script src="libs/three.min.js"></script>
    <script src="libs/DeviceOrientationControls.js"></script>
    <script src="libs/StereoEffect.js"></script>
    <script src="libs/OrbitControls.js"></script>
    <script type="text/javascript">
    var bass, lowMid, highMid, treble, waveform, spectrum, fft;

    function preload() {
        sound = loadSound("data/seaLion3.wav")
    }

    function setup() {
        createCanvas(displayWidth, displayHeight);
        colorMode(HSB); // HUE saturation Brightnes
        sound.amp(0.5, 0.2);
        sound.loop();
        ellipseMode(CENTER);
        fft = new p5.FFT();
    }

    function draw() {
        background(255);
        waveform = fft.waveform();
        spectrum = fft.analyze();
        bass = fft.getEnergy("bass", "lowMid");
        lowMid = fft.getEnergy("lowMid", "mid");
        highMid = fft.getEnergy("mid", "highMid");
        treble = fft.getEnergy("highMid", "treble");

        noStroke();
        translate(width*0.5, height*0.5);
        fill(bass % 360, 100, 100, 5); // modulo is used to make sure it's always a value between o and 360
        ellipse(0, 0, highMid*4, lowMid)*4;
        noStroke();
        fill(treble, 100, 100, 5); // modulo is used to make sure it's always a value between o and 360
        ellipse(width / 2, height / 2, treble, bass);
        noStroke();
        fill(highMid, lowMid, treble, 5); // modulo is used to make sure it's always a value between o and 360
        ellipse(bass, treble/10, bass, treble);
    }
    </script>
</body>

</html>
